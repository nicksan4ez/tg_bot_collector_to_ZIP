# TG_as_file_bot

Небольшой Telegram-бот, который принимает медиасообщения (видео и файлы) от разрешённых пользователей, складывает их во временную директорию и по таймауту отправляет один ZIP-архив в ответ.

## Возможности
- Принимает `video` и `document` (в том числе «Отправить как файл»).
- Сохраняет оригинальные названия файлов, автоматически добавляет расширение при необходимости.
- Складывает все полученные файлы пользователя в архив и отправляет его в исходный чат.
- После отправки архива очищает временную папку пользователя.

## Требования
- Python 3.9 или новее.
- Зависимости из `requirements.txt`.
- Telegram bot token.

## Установка и запуск (локально)
1. Склонируйте репозиторий и перейдите в каталог проекта.
2. Создайте и активируйте виртуальное окружение.
3. Установите зависимости:  
   ```bash
   pip install -r requirements.txt
   ```
4. Скопируйте `.env.example` в `.env` и заполните значения.
5. Запустите бота:
   ```bash
   python bot.py
   ```

## Конфигурация (.env)
- `BOT_TOKEN` — токен Telegram-бота (обязательно).
- `ALLOWED_USERS` — список user_id через запятую; оставьте пустым, чтобы разрешить всем.
- `TMP_ROOT` — путь к каталогу временных файлов (по умолчанию `./telegram_bot_media`).
- `ZIP_NAME` — имя итогового архива (по умолчанию `Monitor.zip`).
- `ARCHIVE_DELAY` — задержка (в секундах) перед сборкой архива после последнего файла (по умолчанию `5`).

## Запуск в Docker
```bash
docker compose up -d --build
```
По умолчанию:
- переменные окружения читаются из `.env`;
- временные файлы складываются в `./data` на хосте и очищаются после отправки архива.

## Структура проекта
- `bot.py` — основной код бота.
- `.env.example` — пример конфигурации.
- `docker-compose.yml`, `Dockerfile` — конфигурация для развёртывания в Docker.
- `requirements.txt` — список зависимостей.
- `telegram_bot_media/` — временный каталог (создаётся при запуске).

## Разработка
Запустите форматирование/проверку:
```bash
python -m compileall bot.py
```
Логи по умолчанию выводятся в stdout.
